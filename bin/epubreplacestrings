#!/usr/bin/env python

import re
import sys


def replace_strings(str):
    str = re.sub("(\. ?){2}\.", "…", str)  # proper ellipses
    str = re.sub("(?<!!)--(?!>)", "—", str)  # em dash
    str = re.sub(
        "(B|b)y the by", "$1y the way", str
    )  # replace By the by with its proper English idiom

    return str


if __name__ == "__main__":
    if len(sys.argv) >= 2:
        with open(sys.argv[1], "r+") as f:
            text = f.read()
            text = replace_strings(text)
            f.seek(0)
            f.write(text)
            f.truncate()
